(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8148:(e,s,t)=>{Promise.resolve().then(t.bind(t,3983))},3983:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>I});var a=t(5155),l=t(2115);let r=e=>{let{children:s,className:t=""}=e;return(0,a.jsx)("div",{className:"rounded-lg border border-gray-700 bg-gray-800 ".concat(t),children:s})},n=e=>{let{children:s,className:t=""}=e;return(0,a.jsx)("div",{className:"p-6 pb-2 ".concat(t),children:s})},i=e=>{let{children:s,className:t=""}=e;return(0,a.jsx)("h3",{className:"text-lg font-semibold text-white ".concat(t),children:s})},o=e=>{let{children:s,className:t=""}=e;return(0,a.jsx)("div",{className:"p-6 ".concat(t),children:s})},d=(0,l.createContext)({isAuthenticated:!1,address:null,username:null,password:null,clearAuth:async()=>{},setPassword:()=>{}});function c(e){let{children:s,value:t,onClearAuth:l}=e,r={...t,clearAuth:l,setPassword:e=>{t.password=e}};return(0,a.jsx)(d.Provider,{value:r,children:s})}class m{static getInstance(){return m.instance||(m.instance=new m),m.instance}async get(e){let s=await fetch("".concat(this.basePath).concat(e));if(!s.ok){let e=await s.text();throw Error("API error (".concat(s.status,"): ").concat(e))}return s.json()}async post(e,s){let t=await fetch("".concat(this.basePath).concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:s?JSON.stringify(s):void 0});if(!t.ok){let e=await t.text();throw Error("API error (".concat(t.status,"): ").concat(e))}return t.json()}constructor(){this.basePath="/api"}}let x=m.getInstance(),u=()=>{let{address:e}=(0,l.useContext)(d),[s,t]=(0,l.useState)(null),[c,m]=(0,l.useState)(!0),[u,h]=(0,l.useState)(null),[p,g]=(0,l.useState)([]),[b,f]=(0,l.useState)(!0),[j,y]=(0,l.useState)(null),[v,N]=(0,l.useState)(new Set),[w,k]=(0,l.useState)(null),[S,C]=(0,l.useState)(!0),[_,E]=(0,l.useState)(!1),[P,T]=(0,l.useState)(null),[I,D]=(0,l.useState)(!1),A=async(s,t)=>{try{return(await x.post("/decrypt/doc_link",{account:e,password:t,encrypted_link:s})).link}catch(e){throw console.error("Error decrypting link:",e),e}},R=async e=>{if(e.includes("WHISPER__")){let s=e.substring(e.indexOf("WHISPER__"));E(!0),T({type:"decrypt_link",data:{link:s}})}else window.open(e,"_blank")},F=async e=>{if((null==P?void 0:P.type)==="decrypt_link")try{D(!0);let s=await A(P.data.link,e);window.open(s,"_blank")}catch(e){h("Failed to decrypt link: ".concat(e instanceof Error?e.message:String(e)))}finally{D(!1),E(!1),T(null)}};(0,l.useEffect)(()=>{(async()=>{if(!e){console.log("No address available"),m(!1);return}console.log("Fetching summary for address:",e);try{let s=await x.get("/account/".concat(e,"/summary"));console.log("Received summary:",s),t(s)}catch(e){console.error("Fetch error:",e),h(e instanceof Error?e.message:"An error occurred")}finally{m(!1)}})()},[e]),(0,l.useEffect)(()=>{(async()=>{if(!e){console.log("No address available for status check"),C(!1);return}console.log("Fetching account status for address:",e);try{let s=await x.get("/account/".concat(e,"/status?refresh=true"));console.log("Received account status data:",JSON.stringify(s,null,2)),k(s)}catch(e){console.error("Status fetch error:",e)}finally{C(!1)}})()},[e]),(0,l.useEffect)(()=>{(async()=>{if(!e)return;let s=async()=>{try{f(!0);let s=await x.get("/tasks/".concat(e)),t=[...s.requested||[],...s.proposed||[],...s.accepted||[],...s.challenged||[],...s.completed||[],...s.refused||[]],a=e=>{let s=e.split("__")[0].replace("_","T")+":00";return new Date(s).getTime()};t.sort((e,s)=>a(s.id)-a(e.id)),g(t.slice(0,10)),y(null)}catch(e){console.error("Error fetching tasks:",e),y(e instanceof Error?e.message:"Failed to fetch tasks")}finally{f(!1)}};await s();let t=setInterval(s,3e4);return()=>clearInterval(t)})()},[e]);let M=[{label:"XRP Balance",value:"number"==typeof(null==s?void 0:s.xrp_balance)?s.xrp_balance.toFixed(6):parseFloat((null==s?void 0:s.xrp_balance)||"0").toFixed(6)},{label:"PFT Balance",value:"number"==typeof(null==s?void 0:s.pft_balance)?s.pft_balance.toFixed(1):parseFloat((null==s?void 0:s.pft_balance)||"0").toFixed(1)}],L=[{label:"Account Address",value:e||"",copyable:!0},{label:"Task Node",value:"r4yc85M1hwsegVGZ1pawpZPwj65SVs8PzD",copyable:!0}],q=S?[]:[...(null==w?void 0:w.init_rite_statement)?[{label:"Initiation Rite",value:'"'.concat(w.init_rite_statement,'"'),className:"italic"}]:[],{label:"Initiation Status",value:(null==w?void 0:w.init_rite_status)||"Unknown",className:(null==w?void 0:w.init_rite_status)==="COMPLETED"?"text-green-400":(null==w?void 0:w.init_rite_status)==="PENDING"?"text-yellow-400":"text-slate-200"},{label:"Blacklist Status",value:(null==w?void 0:w.is_blacklisted)?"BLACKLISTED":"NOT BLACKLISTED",className:(null==w?void 0:w.is_blacklisted)?"text-red-400":"text-green-400"},...(null==w?void 0:w.sweep_address)?[{label:"Sweep Address",value:w.sweep_address,copyable:!0}]:[],...(null==w?void 0:w.context_doc_link)?[{label:"Context Document",value:"View Document",link:w.context_doc_link}]:[]].filter(e=>e),O=async e=>{try{await navigator.clipboard.writeText(e),console.log("Copied to clipboard: ".concat(e))}catch(e){console.error("Failed to copy:",e)}},z=e=>{N(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})};return c||S?(0,a.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,a.jsx)("div",{className:"grid grid-cols-2 gap-6",children:[1,2].map(e=>(0,a.jsx)("div",{className:"bg-slate-900 border-slate-800 rounded-lg p-6 animate-pulse",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"h-4 w-24 bg-slate-700 rounded"}),(0,a.jsx)("div",{className:"h-8 w-32 bg-slate-700 rounded"})]})},e))}),(0,a.jsxs)("div",{className:"bg-slate-900 border-slate-800 rounded-lg",children:[(0,a.jsx)("div",{className:"p-6 border-b border-slate-800",children:(0,a.jsx)("div",{className:"h-6 w-40 bg-slate-700 rounded animate-pulse"})}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[[1,2].map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg bg-slate-800/50 animate-pulse",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-4 w-24 bg-slate-700 rounded"}),(0,a.jsx)("div",{className:"h-4 w-48 bg-slate-700 rounded"})]}),(0,a.jsx)("div",{className:"h-8 w-8 bg-slate-700 rounded"})]},e)),(0,a.jsxs)("div",{className:"border-t border-slate-800 pt-4 mt-4",children:[(0,a.jsx)("div",{className:"h-4 w-32 bg-slate-700 rounded mb-4 animate-pulse"}),[1,2,3,4].map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg bg-slate-800/50 mb-4 animate-pulse",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-4 w-32 bg-slate-700 rounded"}),(0,a.jsx)("div",{className:"h-4 w-48 bg-slate-700 rounded"})]}),(0,a.jsx)("div",{className:"h-8 w-8 bg-slate-700 rounded"})]},e))]})]})]}),(0,a.jsxs)("div",{className:"bg-slate-900 border-slate-800 rounded-lg",children:[(0,a.jsx)("div",{className:"p-6 border-b border-slate-800",children:(0,a.jsx)("div",{className:"h-6 w-40 bg-slate-700 rounded animate-pulse"})}),(0,a.jsx)("div",{className:"p-6 space-y-4",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-800/50 animate-pulse",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"h-4 w-32 bg-slate-700 rounded"}),(0,a.jsx)("div",{className:"h-4 w-20 bg-slate-700 rounded"})]}),(0,a.jsx)("div",{className:"h-4 w-3/4 bg-slate-700 rounded"}),(0,a.jsx)("div",{className:"h-4 w-24 bg-slate-700 rounded"})]})},e))})]})]}):u?(0,a.jsxs)("div",{className:"text-red-500",children:["Error: ",u]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("style",{children:"\n    @keyframes fade-in {\n      from { opacity: 0; }\n      to { opacity: 1; }\n    }\n    \n    .animate-fade-in {\n      animation: fade-in 0.5s ease-out;\n    }\n  "}),(0,a.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,a.jsx)("div",{className:"grid grid-cols-2 gap-6",children:M.map(e=>(0,a.jsx)(r,{className:"bg-slate-900 border-slate-800",children:(0,a.jsx)(o,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-400",children:e.label}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-white mt-1",children:e.value})]})})},e.label))}),(0,a.jsxs)(r,{className:"bg-slate-900 border-slate-800",children:[(0,a.jsx)(n,{children:(0,a.jsx)(i,{className:"text-lg font-semibold text-white",children:"Account Details"})}),(0,a.jsx)(o,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[L.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg bg-slate-800/50",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-400",children:e.label}),(0,a.jsx)("p",{className:"text-sm font-mono text-slate-200 mt-1",children:e.value})]}),e.copyable&&(0,a.jsx)("button",{onClick:()=>O(e.value),className:"p-2 rounded-md hover:bg-slate-700 text-slate-400 hover:text-white transition-colors",title:"Copy to clipboard",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})})]},e.label)),q.length>0&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"border-t border-slate-800 pt-4 mt-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-400 mb-4",children:"Post Fiat Status"}),q.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg bg-slate-800/50 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-slate-400",children:e.label}),e.link?(0,a.jsx)("button",{onClick:()=>R(e.link),className:"text-blue-400 hover:underline hover:text-blue-300 text-sm mt-1",children:e.value}):(0,a.jsx)("p",{className:"text-sm mt-1 ".concat(e.className||"text-slate-200"),children:e.value})]}),e.copyable&&(0,a.jsx)("button",{onClick:()=>O(e.value),className:"p-2 rounded-md hover:bg-slate-700 text-slate-400 hover:text-white transition-colors",title:"Copy to clipboard",children:(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})})})]},s))]})})]})})]}),(0,a.jsxs)(r,{className:"bg-slate-900 border-slate-800",children:[(0,a.jsx)(n,{children:(0,a.jsx)(i,{className:"text-lg font-semibold text-white",children:"Recent Activity"})}),(0,a.jsx)(o,{className:"max-h-[400px] overflow-y-auto",children:b?(0,a.jsx)("div",{className:"text-white",children:"Loading tasks..."}):j?(0,a.jsxs)("div",{className:"text-red-500",children:["Error: ",j]}):0===p.length?(0,a.jsx)("div",{className:"text-slate-500",children:"No recent activity"}):(0,a.jsx)("div",{className:"space-y-4",children:p.map(e=>{let s=e.id.split("__")[0].replace("_"," ");return(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-slate-800/50 hover:bg-slate-800 transition-colors",children:[(0,a.jsxs)("div",{className:"cursor-pointer",onClick:()=>z(e.id),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-slate-400",children:e.message_history&&e.message_history.length>0?e.message_history[0].direction.charAt(0).toUpperCase()+e.message_history[0].direction.slice(1):"Unknown"}),(0,a.jsx)("span",{className:"text-xs font-mono text-slate-500",children:e.id})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-700 text-slate-300",children:e.status}),(0,a.jsx)("svg",{className:"w-4 h-4 text-slate-400 transition-transform ".concat(v.has(e.id)?"transform rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]}),(0,a.jsx)("p",{className:"text-sm text-slate-300 mb-2",children:e.message_history&&e.message_history.length>0?e.message_history[0].data:"No message available"}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:s})]}),v.has(e.id)&&e.message_history&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-700",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"Message History"}),(0,a.jsx)("div",{className:"space-y-3",children:Array.from(new Map(e.message_history.map(e=>["".concat(e.direction,":").concat(e.data),e])).values()).map((e,s)=>(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("span",{className:"text-slate-400 font-medium",children:[e.direction.charAt(0).toUpperCase()+e.direction.slice(1),":"]}),(0,a.jsx)("p",{className:"text-slate-300 mt-1 pl-4",children:e.data})]},s))})]})]},e.id)})})})]})]}),_&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg p-6 w-full max-w-md",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Enter Password"}),(0,a.jsx)("p",{className:"text-slate-400 mb-4",children:"Your password is needed to decrypt the document link."}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),F(e.currentTarget.elements.namedItem("password").value)},children:[(0,a.jsx)("input",{type:"password",name:"password",className:"w-full p-3 bg-slate-800 border border-slate-700 rounded-md text-white mb-4",placeholder:"Your wallet password",required:!0}),u&&(0,a.jsx)("div",{className:"text-red-400 mb-4",children:u}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{E(!1),T(null)},className:"px-4 py-2 bg-slate-800 text-white rounded-md hover:bg-slate-700",disabled:I,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",disabled:I,children:I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Confirm"})]})]})]})})]})};function h(e){let{isOpen:s,onClose:t,onConfirm:r,error:n}=e,[i,o]=(0,l.useState)(""),[d,c]=(0,l.useState)(!1);if(!s)return null;let m=async e=>{e.preventDefault(),c(!0);try{await r(i),o("")}finally{c(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg w-full max-w-md",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Confirm Password"}),(0,a.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-300",children:"Enter your password to sign this transaction"}),(0,a.jsx)("input",{type:"password",value:i,onChange:e=>o(e.target.value),className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50",placeholder:"Password",required:!0})]}),n&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:n}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Confirming...":"Confirm"})]})]})]})})})}let p=e=>{let{isOpen:s,onClose:t,taskId:r,onAccept:n,initialMessage:i}=e,[o,c]=(0,l.useState)(i),[m,u]=(0,l.useState)(!1),[p,g]=(0,l.useState)(""),[b,f]=(0,l.useState)(!1),{address:j,username:y,password:v}=(0,l.useContext)(d);if((0,l.useEffect)(()=>{c(i)},[i]),!s)return null;let N=async e=>{if(e.preventDefault(),!v){f(!0);return}await w(v)},w=async e=>{g(""),u(!0);try{let s={account:j,tx_type:"task_acceptance",password:e,data:{message:o,task_id:r,username:y}};console.log("Sending request data:",{...s,password:"[REDACTED]"});let a=await x.post("/transaction/send",s);console.log("Success response:",a),n(r,o),c(""),t()}catch(e){console.error("Error accepting task:",e),g(e instanceof Error?e.message:"Failed to accept task")}finally{u(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg w-full max-w-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Accept Task"}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Task ID"}),(0,a.jsx)("input",{type:"text",value:r,disabled:!0,className:"w-full px-4 py-2.5 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Acceptance Message"}),(0,a.jsx)("textarea",{value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50 min-h-[100px]",placeholder:"Enter your acceptance message...",required:!0,maxLength:1e3}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("span",{className:"text-xs ".concat(o.length>=950?"text-amber-400":"text-slate-500"),children:[o.length,"/1000"]})})]}),p&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:p}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Sending...":"Accept Task"})]})]})]})})}),(0,a.jsx)(h,{isOpen:b,onClose:()=>f(!1),onConfirm:async e=>{f(!1),await w(e)},error:p})]})};function g(e){let{isOpen:s,onClose:t,onRequest:r,initialMessage:n}=e,[i,o]=(0,l.useState)(n),[c,m]=(0,l.useState)(!1),[u,p]=(0,l.useState)(""),[g,b]=(0,l.useState)(!1),{address:f,username:j,password:y}=(0,l.useContext)(d);if((0,l.useEffect)(()=>{o(n)},[n]),!s)return null;let v=async e=>{if(e.preventDefault(),!y){b(!0);return}await N(y)},N=async e=>{p(""),m(!0);try{let s=function(){let e=new Date,s="ABCDEFGHIJKLMNOPQRSTUVWXYZ",t="0123456789",a=Array.from({length:2},()=>s[Math.floor(Math.random()*s.length)]).join(""),l=Array.from({length:2},()=>t[Math.floor(Math.random()*t.length)]).join(""),r=e.toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).replace(/(\d+)\/(\d+)\/(\d+),\s(\d+):(\d+)/,"$3-$1-$2_$4:$5");return"".concat(r,"__").concat(a).concat(l)}(),a={account:f,tx_type:"task_request",password:e,data:{request:i,task_id:s,username:j}};console.log("Sending request data:",{...a,password:"[REDACTED]"});let l=await x.post("/transaction/send",a);console.log("Success response:",l),r(i),o(""),t()}catch(e){console.error("Error sending task request:",e),p(e instanceof Error?e.message:"Failed to send request")}finally{m(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg w-full max-w-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Request Task"}),(0,a.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-300",children:"Task Request Message"}),(0,a.jsx)("textarea",{value:i,onChange:e=>o(e.target.value),className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50",placeholder:"Enter your task request...",required:!0,maxLength:1e3}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("span",{className:"text-xs ".concat(i.length>=950?"text-amber-400":"text-slate-500"),children:[i.length,"/1000"]})})]}),u&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:u}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Sending...":"Submit Request"})]})]})]})})}),(0,a.jsx)(h,{isOpen:g,onClose:()=>b(!1),onConfirm:async e=>{b(!1),await N(e)},error:u})]})}let b=e=>{let{isOpen:s,onClose:t,taskId:r,onRefuse:n,initialReason:i}=e,[o,c]=(0,l.useState)(i),[m,u]=(0,l.useState)(!1),[p,g]=(0,l.useState)(""),[b,f]=(0,l.useState)(!1),{address:j,username:y,password:v}=(0,l.useContext)(d);if((0,l.useEffect)(()=>{c(i)},[i]),!s)return null;let N=async e=>{if(e.preventDefault(),!v){f(!0);return}await w(v)},w=async e=>{g(""),u(!0);try{let s={account:j,tx_type:"task_refusal",password:e,data:{refusal_reason:o,task_id:r,username:y}};console.log("Sending request data:",{...s,password:"[REDACTED]"});let a=await x.post("/transaction/send",s);console.log("Success response:",a),n(r,o),c(""),t()}catch(e){console.error("Error refusing task:",e),g(e instanceof Error?e.message:"Failed to refuse task")}finally{u(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg w-full max-w-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Refuse Task"}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Task ID"}),(0,a.jsx)("input",{type:"text",value:r,disabled:!0,className:"w-full px-4 py-2.5 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Reason for Refusal"}),(0,a.jsx)("textarea",{value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50 min-h-[100px]",placeholder:"Enter reason for refusing the task...",required:!0,maxLength:1e3}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("span",{className:"text-xs ".concat(o.length>=950?"text-amber-400":"text-slate-500"),children:[o.length,"/1000"]})})]}),p&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:p}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-red-600 hover:bg-red-500  text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Sending...":"Refuse Task"})]})]})]})})}),(0,a.jsx)(h,{isOpen:b,onClose:()=>f(!1),onConfirm:async e=>{f(!1),await w(e)},error:p})]})},f=e=>{let{isOpen:s,onClose:t,taskId:r,onSubmit:n,initialDetails:i}=e,[o,c]=(0,l.useState)(i),[m,u]=(0,l.useState)(!1),[p,g]=(0,l.useState)(""),[b,f]=(0,l.useState)(!1),{address:j,username:y,password:v}=(0,l.useContext)(d);if((0,l.useEffect)(()=>{c(i)},[i]),!s)return null;let N=async e=>{if(e.preventDefault(),!v){f(!0);return}await w(v)},w=async e=>{g(""),u(!0);try{let s={account:j,tx_type:"task_completion",password:e,data:{completion_justification:o,task_id:r,username:y}};console.log("Sending request data:",{...s,password:"[REDACTED]"});let a=await x.post("/transaction/send",s);console.log("Success response:",a),n(r,o),c(""),t()}catch(e){console.error("Error submitting completion:",e),g(e instanceof Error?e.message:"Failed to submit completion")}finally{u(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg w-full max-w-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Submit for Verification"}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Task ID"}),(0,a.jsx)("input",{type:"text",value:r,disabled:!0,className:"w-full px-4 py-2.5 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Verification Details"}),(0,a.jsx)("textarea",{value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50 min-h-[200px]",placeholder:"Enter verification details...",required:!0,maxLength:1e3}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("span",{className:"text-xs ".concat(o.length>=950?"text-amber-400":"text-slate-500"),children:[o.length,"/1000"]})})]}),p&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:p}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Sending...":"Submit Verification"})]})]})]})})}),(0,a.jsx)(h,{isOpen:b,onClose:()=>f(!1),onConfirm:async e=>{f(!1),await w(e)},error:p})]})},j=e=>{let{isOpen:s,onClose:t,taskId:r,onSubmit:n,initialDetails:i,verificationPrompt:o}=e,[c,m]=(0,l.useState)(i),[u,p]=(0,l.useState)(!1),[g,b]=(0,l.useState)(""),[f,j]=(0,l.useState)(!1),{address:y,username:v,password:N}=(0,l.useContext)(d);if((0,l.useEffect)(()=>{m(i)},[i]),!s)return null;let w=async e=>{if(e.preventDefault(),!N){j(!0);return}await k(N)},k=async e=>{b(""),p(!0);try{let s={account:y,tx_type:"verification_response",password:e,data:{verification_response:c,task_id:r,username:v}};console.log("Sending request data:",{...s,password:"[REDACTED]"});let a=await x.post("/transaction/send",s);console.log("Success response:",a),n(r,c),m(""),t()}catch(e){console.error("Error submitting verification response:",e),b(e instanceof Error?e.message:"Failed to submit verification response")}finally{p(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg w-full max-w-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Submit Verification Response"}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Task ID"}),(0,a.jsx)("input",{type:"text",value:r,disabled:!0,className:"w-full px-4 py-2.5 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500"})]}),o&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Verification Prompt"}),(0,a.jsx)("div",{className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg  text-slate-300 text-sm max-h-[150px] overflow-y-auto",children:o})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Verification Response"}),(0,a.jsx)("textarea",{value:c,onChange:e=>m(e.target.value),className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50 min-h-[200px]",placeholder:"Enter your verification response...",required:!0,maxLength:1e3}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("span",{className:"text-xs ".concat(c.length>=950?"text-amber-400":"text-slate-500"),children:[c.length,"/1000"]})})]}),g&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:g}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:u,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Sending...":"Submit Response"})]})]})]})})}),(0,a.jsx)(h,{isOpen:f,onClose:()=>j(!1),onConfirm:async e=>{j(!1),await k(e)},error:g})]})},y=e=>{let{isOpen:s,onClose:t,onSubmit:r,initialDetails:n}=e,[i,o]=(0,l.useState)(n),[c,m]=(0,l.useState)(!1),[u,p]=(0,l.useState)(""),[g,b]=(0,l.useState)(!1),{address:f,username:j,password:y}=(0,l.useContext)(d);if((0,l.useEffect)(()=>{o(n)},[n]),!s)return null;let v=async e=>{if(e.preventDefault(),!y){b(!0);return}await N(y)},N=async e=>{p(""),m(!0);try{let s="pomo_".concat(Date.now()),a={account:f,password:e,log_message:i,log_id:s,username:j,use_pft:!0};console.log("Sending PF Log request:",{...a,password:"[REDACTED]"});let l=await x.post("/transaction/pf_log",a);console.log("PF Log success response:",l),r(i),t()}catch(e){console.error("Error submitting PF log:",e),p(e instanceof Error?e.message:"Failed to submit PF log")}finally{m(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg w-full max-w-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Submit Pomodoro Log"}),(0,a.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Log Message"}),(0,a.jsx)("textarea",{value:i,onChange:e=>o(e.target.value),className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50 min-h-[200px]",placeholder:"Enter your log message...",required:!0})]}),u&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:u}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Sending...":"Submit Log"})]})]})]})})}),(0,a.jsx)(h,{isOpen:g,onClose:()=>b(!1),onConfirm:async e=>{b(!1),await N(e)},error:u})]})},v=()=>{let{isAuthenticated:e,address:s,username:t,password:c}=(0,l.useContext)(d),[m,u]=(0,l.useState)([]),[h,v]=(0,l.useState)(!0),[N,w]=(0,l.useState)(null),[k,S]=(0,l.useState)(!1),[C,_]=(0,l.useState)(new Set),[E,P]=(0,l.useState)(new Set),[T,I]=(0,l.useState)(""),[D,A]=(0,l.useState)({accept:!1,request:!1,refuse:!1,verify:!1,finalVerify:!1,logPomodoro:!1,verificationPrompt:""}),[R,F]=(0,l.useState)(null),[M,L]=(0,l.useState)(!1),[q,O]=(0,l.useState)("all"),z=async()=>{if(!s){v(!1);return}L(!0),w(null);try{await new Promise(e=>setTimeout(e,1e3));let e=await x.get("/tasks/".concat(s)),t=[...e.requested||[],...e.proposed||[],...e.accepted||[],...e.challenged||[],...k&&e.refused||[]],a=e=>{let s=e.split("__")[0].replace("_","T")+":00";return new Date(s).getTime()};t.sort((e,s)=>a(s.id)-a(e.id)),u(t)}catch(e){console.error("Error fetching tasks:",e),w(e instanceof Error?e.message:"Failed to fetch tasks")}finally{L(!1),v(!1)}};(0,l.useEffect)(()=>{if(e&&s)return(async()=>{try{await x.post("/tasks/start-refresh/".concat(s)),console.log("Started task refresh loop")}catch(e){console.error("Failed to start refresh loop:",e)}})(),z(),()=>{s&&x.post("/tasks/stop-refresh/".concat(s)).catch(e=>{console.error("Failed to stop refresh loop:",e)})}},[e,s]),(0,l.useEffect)(()=>{if(!e||!s)return;let t=setInterval(()=>{z()},3e4);return()=>clearInterval(t)},[e,s]),(0,l.useEffect)(()=>{z()},[k]);let W=e=>{_(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},V=e=>{P(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},B=e=>{I(e)},H=e=>{if("request"!==e&&"logPomodoro"!==e&&(!T||!m.some(e=>e.id===T))){F("Please select a valid task first");return}F(null);let s="";if("verify"===e||"finalVerify"===e){let e=m.find(e=>e.id===T);if(null==e?void 0:e.message_history){let t=e.message_history.find(e=>e.data.includes("VERIFICATION PROMPT"));t?s=t.data:e.message_history.length>=5&&(s=e.message_history[4].data)}}A({...D,[e]:!0,verificationPrompt:s})},U=e=>{A({...D,[e]:!1}),F(null)},G=async(e,s)=>{try{console.log("Accepting task:",e,s),U("accept"),await z(),u(s=>s.filter(s=>s.id!==e))}catch(e){console.error("Error accepting task:",e)}},X=async e=>{try{console.log("Requesting task:",e),U("request"),await z()}catch(e){console.error("Error requesting task:",e)}},Y=async(e,s)=>{try{console.log("Refusing task:",e,s),U("refuse"),u(s=>s.filter(s=>s.id!==e)),await z()}catch(e){console.error("Error refusing task:",e)}},J=async(e,s)=>{try{console.log("Verification submitted:",e,s),U("verify"),u(s=>s.filter(s=>s.id!==e)),await z()}catch(e){console.error("Error handling verification submission:",e)}},K=async(e,s)=>{try{console.log("Final verification submitted:",e,s),U("finalVerify"),u(s=>s.filter(s=>s.id!==e)),await z()}catch(e){console.error("Error handling final verification:",e)}},$=async e=>{try{console.log("Pomodoro logged:",e),U("logPomodoro"),await z()}catch(e){console.error("Error logging pomodoro:",e)}},Z=m.filter(e=>"all"===q||e.status===q),Q=e=>{var s;if(!(null===(s=e.message_history)||void 0===s?void 0:s.length))return"No message available";for(let s=0;s<e.message_history.length;s++){let t=e.message_history[s];if(t.data.startsWith("PROPOSED PF"))return t.data}return e.message_history.length>=2?e.message_history[1].data:e.message_history[0].data},ee=(e,s)=>e.length<=300||E.has(s)?(0,a.jsx)("p",{className:"text-sm text-slate-300",children:e}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-slate-300",children:[e.substring(0,300),"..."]}),(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),V(s)},className:"text-xs text-emerald-400 hover:text-emerald-300 mt-1",children:"Show more"})]}),es=e=>{switch(e.status){case"proposed":return(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),I(e.id),H("accept")},className:"px-3 py-1 text-xs font-medium bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors",children:"Accept"}),(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),I(e.id),H("refuse")},className:"px-3 py-1 text-xs font-medium bg-slate-700 hover:bg-slate-600  text-white rounded-lg transition-colors",children:"Refuse"})]});case"accepted":return(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),I(e.id),H("verify")},className:"px-3 py-1 text-xs font-medium bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors",children:"Submit for Verification"}),(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),I(e.id),H("refuse")},className:"px-3 py-1 text-xs font-medium bg-slate-700 hover:bg-slate-600  text-white rounded-lg transition-colors",children:"Refuse"})]});case"challenged":return(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),I(e.id),H("finalVerify")},className:"px-3 py-1 text-xs font-medium bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors",children:"Submit Verification Details"}),(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),I(e.id),H("refuse")},className:"px-3 py-1 text-xs font-medium bg-slate-700 hover:bg-slate-600  text-white rounded-lg transition-colors",children:"Refuse"})]});default:return null}};return h?(0,a.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[1,2,3,4].map(e=>(0,a.jsx)("div",{className:"h-10 w-24 bg-slate-800 rounded-lg animate-pulse"},e))}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-10 w-28 bg-emerald-600/50 rounded-lg animate-pulse"}),(0,a.jsx)("div",{className:"h-10 w-24 bg-slate-800 rounded-lg animate-pulse"})]})]}),(0,a.jsxs)(r,{className:"bg-slate-900 border-slate-800",children:[(0,a.jsx)(n,{children:(0,a.jsx)("div",{className:"h-6 w-32 bg-slate-700 rounded animate-pulse"})}),(0,a.jsx)(o,{className:"max-h-[600px] overflow-y-auto space-y-4",children:[1,2,3,4].map(e=>(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-800/50",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-4 w-48 bg-slate-700 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-5 w-20 bg-blue-500/10 rounded-full animate-pulse"})]}),(0,a.jsx)("div",{className:"h-7 w-28 bg-slate-700 rounded-full animate-pulse"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-4 w-full bg-slate-700 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-4 w-3/4 bg-slate-700 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-4 w-1/2 bg-slate-700 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-3 w-32 bg-slate-700 rounded animate-pulse mt-2"})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)("div",{className:"h-7 w-24 bg-emerald-600/50 rounded-lg animate-pulse"}),(0,a.jsx)("div",{className:"h-7 w-20 bg-slate-700 rounded-lg animate-pulse"})]})]})},e))})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("style",{children:"\n    @keyframes fade-in {\n      from { opacity: 0; }\n      to { opacity: 1; }\n    }\n    \n    .animate-fade-in {\n      animation: fade-in 0.5s ease-out;\n    }\n  "}),(0,a.jsxs)("div",{className:"space-y-6",children:[!e&&(0,a.jsx)("div",{className:"text-white",children:"Please sign in to view tasks."}),e&&!s&&(0,a.jsx)("div",{className:"text-white",children:"No wallet address found."}),N&&(0,a.jsxs)("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"font-medium",children:"Error:"}),(0,a.jsx)("p",{children:N})]}),e&&s&&!h&&(0,a.jsxs)(a.Fragment,{children:[R&&(0,a.jsx)("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4 mb-4",children:(0,a.jsx)("p",{className:"text-red-400 text-sm",children:R})}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[(0,a.jsx)("button",{onClick:()=>O("all"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("all"===q?"bg-emerald-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"),children:"All Tasks"}),(0,a.jsx)("button",{onClick:()=>O("proposed"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("proposed"===q?"bg-emerald-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"),children:"Proposed"}),(0,a.jsx)("button",{onClick:()=>O("accepted"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("accepted"===q?"bg-emerald-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"),children:"Accepted"}),(0,a.jsx)("button",{onClick:()=>O("challenged"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("challenged"===q?"bg-emerald-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"),children:"Verification"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{onClick:()=>H("request"),className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors text-sm font-medium",children:"Request Task"}),(0,a.jsx)("button",{onClick:()=>z(),disabled:M,className:"px-4 py-2 bg-slate-800 hover:bg-slate-700  text-white rounded-lg transition-all duration-200 text-sm font-medium disabled:opacity-75 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:M?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,a.jsx)("span",{children:"Refreshing..."})]}):"Refresh"})]})]}),(0,a.jsxs)(r,{className:"bg-slate-900 border-slate-800",children:[(0,a.jsx)(n,{children:(0,a.jsx)(i,{className:"text-lg font-semibold text-white",children:"Active Tasks"})}),(0,a.jsx)(o,{className:"max-h-[600px] overflow-y-auto",children:0===Z.length?(0,a.jsx)("div",{className:"text-slate-500",children:"No tasks available."}):(0,a.jsx)("div",{className:"space-y-4",children:Z.map(e=>{let s=e.id.split("__")[0].replace("_"," "),t=Q(e);return(0,a.jsx)("div",{className:"p-4 rounded-lg bg-slate-800/50 hover:bg-slate-800 transition-colors cursor-pointer",onClick:()=>B(e.id),children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-xs font-mono text-slate-500",children:e.id}),(0,a.jsx)("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("accepted"===e.status?"bg-emerald-500/10 text-emerald-400":"requested"===e.status?"bg-yellow-500/10 text-yellow-400":"proposed"===e.status?"bg-blue-500/10 text-blue-400":"challenged"===e.status?"bg-purple-500/10 text-purple-400":"bg-red-500/10 text-red-400"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),W(e.id)},className:"px-3 py-1 text-xs font-medium text-slate-400 hover:text-white  bg-slate-700/50 hover:bg-slate-700 rounded-full transition-colors",children:C.has(e.id)?"Hide Messages":"Show Messages"})]}),(0,a.jsxs)("div",{children:[ee(t,e.id),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:s})]}),es(e),C.has(e.id)&&e.message_history&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-700",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"Message History"}),(0,a.jsx)("div",{className:"space-y-3",children:Array.from(new Map(e.message_history.map(e=>["".concat(e.direction,":").concat(e.data),e])).values()).map((e,s)=>(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("span",{className:"text-slate-400 font-medium",children:[e.direction,":"]}),(0,a.jsx)("p",{className:"text-slate-300 mt-1 pl-4",children:e.data})]},s))})]})]})},e.id)})})})]}),(0,a.jsx)(p,{isOpen:D.accept,onClose:()=>U("accept"),taskId:T,onAccept:(e,s)=>{G(e,s)},initialMessage:""}),(0,a.jsx)(g,{isOpen:D.request,onClose:()=>U("request"),onRequest:e=>{X(e)},initialMessage:""}),(0,a.jsx)(b,{isOpen:D.refuse,onClose:()=>U("refuse"),taskId:T,onRefuse:(e,s)=>{Y(e,s)},initialReason:""}),(0,a.jsx)(f,{isOpen:D.verify,onClose:()=>U("verify"),taskId:T,onSubmit:(e,s)=>{J(e,s)},initialDetails:""}),(0,a.jsx)(j,{isOpen:D.finalVerify,onClose:()=>U("finalVerify"),taskId:T,onSubmit:(e,s)=>{K(e,s)},initialDetails:"",verificationPrompt:D.verificationPrompt}),(0,a.jsx)(y,{isOpen:D.logPomodoro,onClose:()=>U("logPomodoro"),onSubmit:$,initialDetails:""})]})]})]})},N=()=>{let{isAuthenticated:e,address:s}=(0,l.useContext)(d),[t,c]=(0,l.useState)([]),[m,x]=(0,l.useState)(!0),[u,h]=(0,l.useState)(null),[p,g]=(0,l.useState)(new Set),[f,v]=(0,l.useState)(""),[N,w]=(0,l.useState)(!1),[k,S]=(0,l.useState)(!1),[C,_]=(0,l.useState)(""),[E,P]=(0,l.useState)(!1),[T,I]=(0,l.useState)(!1),[D,A]=(0,l.useState)(""),R=async()=>{if(!s){x(!1);return}P(!0);try{let[e]=await Promise.all([fetch("http://localhost:8000/api/tasks/".concat(s)),new Promise(e=>setTimeout(e,1e3))]);if(!e.ok){let s=await e.text();throw Error("Failed to fetch tasks: ".concat(s))}let t=(await e.json()).challenged||[],a=e=>{let s=e.split("__")[0].replace("_","T")+":00";return new Date(s).getTime()};t.sort((e,s)=>a(s.id)-a(e.id)),c(t)}catch(e){h(e instanceof Error?e.message:"An error occurred")}finally{x(!1),P(!1)}};(0,l.useEffect)(()=>{if(!e||!s)return;R();let t=setInterval(R,3e4);return()=>clearInterval(t)},[e,s]),(0,l.useEffect)(()=>{A("Please provide verification details for this task.")},[]);let F=e=>{g(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},M=(e,s)=>{R()},L=(e,s)=>{R()},q=async e=>{_(""),R()};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(r,{className:"bg-slate-900 border-slate-800",children:[(0,a.jsx)(n,{children:(0,a.jsx)(i,{className:"text-lg font-semibold text-white",children:"Submit Verification"})}),(0,a.jsxs)(o,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Task ID"}),(0,a.jsx)("input",{type:"text",value:f,onChange:e=>v(e.target.value),className:"w-full px-4 py-2.5 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50",placeholder:"Enter task ID"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-400",children:"Verification Details"}),(0,a.jsx)("textarea",{value:C,onChange:e=>_(e.target.value),className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50 min-h-[200px]",placeholder:"Enter verification details"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("button",{onClick:()=>w(!0),className:"w-full px-4 py-2.5 bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors text-sm font-medium",children:"Submit Verification Details"}),(0,a.jsx)("button",{onClick:()=>S(!0),className:"w-full px-4 py-2.5 bg-slate-800 hover:bg-slate-700  text-white rounded-lg transition-colors text-sm font-medium",children:"Refuse"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("button",{onClick:()=>I(!0),className:"w-full px-4 py-2.5 bg-slate-800 hover:bg-slate-700  text-white rounded-lg transition-colors text-sm font-medium",children:"Log Pomodoro"}),(0,a.jsx)("button",{onClick:()=>R(),disabled:E,className:"w-full px-4 py-2.5 bg-slate-800 hover:bg-slate-700  text-white rounded-lg transition-all duration-200 text-sm font-medium disabled:opacity-75 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,a.jsx)("span",{children:"Updating..."})]}):"Force Update"})]})]})]})]}),(0,a.jsxs)(r,{className:"bg-slate-900 border-slate-800",children:[(0,a.jsx)(n,{children:(0,a.jsx)(i,{className:"text-lg font-semibold text-white",children:"Verification History"})}),(0,a.jsx)(o,{children:m?(0,a.jsx)("div",{className:"text-slate-500",children:"Loading tasks..."}):u?(0,a.jsxs)("div",{className:"text-red-500",children:["Error: ",u]}):0===t.length?(0,a.jsx)("div",{className:"text-slate-500",children:"No tasks available for verification."}):(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>{var s,t;let l=e.id.split("__")[0].replace("_"," "),r=(null===(t=e.message_history)||void 0===t?void 0:null===(s=t[4])||void 0===s?void 0:s.data)||"No verification message available";return(0,a.jsxs)("div",{className:"p-4 rounded-lg bg-slate-800/50 cursor-pointer hover:bg-slate-800",onClick:()=>v(e.id),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-xs font-mono text-slate-400",children:e.id}),(0,a.jsx)("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-700 text-slate-300",children:"Challenged"})]}),(0,a.jsx)("button",{onClick:s=>{s.stopPropagation(),F(e.id)},className:"px-3 py-1 text-xs font-medium text-slate-400 hover:text-white  bg-slate-700/50 hover:bg-slate-700 rounded-full transition-colors",children:p.has(e.id)?"Hide Messages":"Show Messages"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-slate-400 mb-1",children:"Verification Message"}),(0,a.jsx)("p",{className:"text-sm text-slate-300",children:r}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:l})]}),p.has(e.id)&&e.message_history&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-slate-700",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"Message History"}),(0,a.jsx)("div",{className:"space-y-3",children:e.message_history.map((e,s)=>(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("span",{className:"text-slate-400 font-medium",children:[e.direction.charAt(0).toUpperCase()+e.direction.slice(1),":"]}),(0,a.jsx)("p",{className:"text-slate-300 mt-1 pl-4",children:e.data})]},s))})]})]})]},e.id)})})})]}),(0,a.jsx)(j,{isOpen:N,onClose:()=>w(!1),taskId:f,onSubmit:(e,s)=>{M(e,s),_("")},initialDetails:C,verificationPrompt:D}),(0,a.jsx)(b,{isOpen:k,onClose:()=>S(!1),taskId:f,onRefuse:(e,s)=>{L(e,s),_("")},initialReason:C}),(0,a.jsx)(y,{isOpen:T,onClose:()=>I(!1),onSubmit:q,initialDetails:C})]})},w=()=>{let{isAuthenticated:e,address:s}=(0,l.useContext)(d),[t,r]=(0,l.useState)([]),[n,i]=(0,l.useState)(!0),[o,c]=(0,l.useState)(null),[m,u]=(0,l.useState)("all"),h=async()=>{if(!s){i(!1);return}try{let e=await x.get("/tasks/".concat(s)),t=[...e.rewarded||[],...e.refused||[]];t=t.map(s=>{var t;return(null===(t=e.rewarded)||void 0===t?void 0:t.some(e=>e.id===s.id))?{...s,status:"rewarded"}:{...s,status:"refused"}});let a=e=>{let s=e.split("__")[0].replace("_","T")+":00";return new Date(s).getTime()};t.sort((e,s)=>a(s.id)-a(e.id)),r(t)}catch(e){c(e instanceof Error?e.message:"An error occurred")}finally{i(!1)}};(0,l.useEffect)(()=>{if(!e||!s)return;h();let t=setInterval(()=>{h()},3e4);return()=>clearInterval(t)},[e,s]);let p=t.filter(e=>"all"===m||e.status===m),g="\n    @keyframes fade-in {\n      from { opacity: 0; }\n      to { opacity: 1; }\n    }\n    \n    .animate-fade-in {\n      animation: fade-in 0.5s ease-out;\n    }\n  ";return n?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-900 text-gray-100 p-4 space-y-6 animate-fade-in",children:[(0,a.jsx)("style",{children:g}),(0,a.jsx)("div",{className:"h-8 w-48 bg-slate-700 rounded animate-pulse"}),(0,a.jsx)("div",{className:"flex space-x-4 mb-4",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"h-10 w-24 bg-slate-700 rounded-lg animate-pulse"},e))}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"max-h-[calc(100vh-200px)] overflow-y-auto",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-gray-900 z-10",children:(0,a.jsx)("tr",{className:"border-b border-gray-700",children:["Task ID","Proposal","Reward/Refusal","Payout"].map((e,s)=>(0,a.jsx)("th",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-24 bg-slate-700 rounded animate-pulse"})},s))})}),(0,a.jsx)("tbody",{children:[1,2,3,4,5].map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-800",children:[(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-48 bg-slate-700 rounded animate-pulse"})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-4 w-full bg-slate-700 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-4 w-3/4 bg-slate-700 rounded animate-pulse"})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"h-4 w-full bg-slate-700 rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-4 w-2/3 bg-slate-700 rounded animate-pulse"})]})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-20 bg-slate-700 rounded animate-pulse"})})]},e))})]})})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-900 text-gray-100 p-4",children:[(0,a.jsx)("style",{children:g}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Finished Tasks"}),!e&&(0,a.jsx)("div",{className:"text-white",children:"Please sign in to view your finished tasks."}),e&&!s&&(0,a.jsx)("div",{className:"text-white",children:"No wallet address found."}),o&&(0,a.jsxs)("div",{className:"text-red-500",children:["Error: ",o]}),e&&s&&!n&&(0,a.jsxs)("div",{className:"space-y-6 animate-fade-in",children:[(0,a.jsxs)("div",{className:"flex space-x-4 mb-4",children:[(0,a.jsx)("button",{onClick:()=>u("all"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("all"===m?"bg-emerald-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"),children:"All Tasks"}),(0,a.jsx)("button",{onClick:()=>u("rewarded"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("rewarded"===m?"bg-emerald-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"),children:"Rewarded"}),(0,a.jsx)("button",{onClick:()=>u("refused"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("refused"===m?"bg-emerald-600 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700"),children:"Refused"})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"max-h-[calc(100vh-200px)] overflow-y-auto",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-gray-900 z-10",children:(0,a.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"Task ID"}),(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"Proposal"}),(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"Reward/Refusal"}),(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"Payout"})]})}),(0,a.jsx)("tbody",{children:0===p.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"p-4 text-gray-400 text-center",children:"No tasks available."})}):p.map(e=>{var s,t;let l=e.message_history&&e.message_history.length>1?e.message_history[1].data:"No proposal available",r="rewarded"===e.status&&(null===(s=e.message_history)||void 0===s?void 0:s.length)>1?e.message_history[e.message_history.length-1].data:null,n="refused"===e.status&&(null===(t=e.message_history)||void 0===t?void 0:t.length)>1?e.message_history[e.message_history.length-1].data:null,i="rewarded"===e.status&&r?r:"refused"===e.status&&n?n:"No response available";return(0,a.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,a.jsx)("td",{className:"p-4 text-gray-300 font-mono align-top whitespace-nowrap",children:e.id}),(0,a.jsx)("td",{className:"p-4 text-gray-300 align-top max-w-md",children:(0,a.jsx)("div",{className:"line-clamp-4",children:l})}),(0,a.jsx)("td",{className:"p-4 text-gray-300 align-top max-w-lg",children:(0,a.jsx)("div",{className:"line-clamp-4",children:i})}),(0,a.jsx)("td",{className:"p-4 text-gray-300 align-top whitespace-nowrap",children:"rewarded"===e.status?"".concat(e.pft_rewarded||e.pft_offered||"N/A"," PFT"):""})]},e.id)})})]})})})]})]})};function k(e){let{isOpen:s,onClose:t,onSubmit:r,initialAmount:n,initialToAddress:i,initialCurrency:o,initialMemoId:c,initialMemo:m}=e,{address:u}=(0,l.useContext)(d),[p,g]=(0,l.useState)(n),[b,f]=(0,l.useState)(i),[j,y]=(0,l.useState)(o),[v,N]=(0,l.useState)(c||""),[w,k]=(0,l.useState)(m||""),[S,C]=(0,l.useState)(!1),[_,E]=(0,l.useState)(""),[P,T]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{g(n),f(i),y(o),N(c||""),k(m||"")},[n,i,o,c,m]),!s)return null;let I=async e=>{if(e.preventDefault(),!p||!b){E("Amount and destination address are required");return}T(!0)},D=async e=>{E(""),C(!0);try{let s={from_account:u,to_address:b,amount:p,currency:j,password:e,memo_id:v||void 0,memo:w||void 0};console.log("Payment request:",{...s,password:"[REDACTED]"});let a=await x.post("/transaction/payment",s);console.log("Payment success response:",a),t()}catch(e){console.error("Error sending payment:",e),E(e instanceof Error?e.message:"Failed to send payment")}finally{C(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg w-full max-w-lg",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-white mb-4",children:"Send Payment"}),(0,a.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:p,readOnly:!0,className:"flex-1 px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50",placeholder:"Amount",required:!0}),(0,a.jsxs)("select",{value:j,disabled:!0,className:"px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50",children:[(0,a.jsx)("option",{value:"XRP",children:"XRP"}),(0,a.jsx)("option",{value:"PFT",children:"PFT"})]})]}),(0,a.jsx)("input",{type:"text",value:b,readOnly:!0,className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50",placeholder:"Destination Address",required:!0}),(0,a.jsx)("input",{type:"text",value:v,readOnly:!0,className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50",placeholder:"Memo ID (Optional)"}),(0,a.jsx)("input",{type:"text",value:w,readOnly:!0,className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg  text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2  focus:ring-emerald-500/50 focus:border-emerald-500/50",placeholder:"Memo (Optional)"})]}),_&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:_}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:S,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500  text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:S?"Sending...":"Send Payment"})]})]})]})})}),(0,a.jsx)(h,{isOpen:P,onClose:()=>T(!1),onConfirm:async e=>{T(!1),await D(e)},error:_})]})}let S=()=>{let{address:e}=(0,l.useContext)(d),[s,t]=(0,l.useState)("XRP"),[r,n]=(0,l.useState)([]),[i,o]=(0,l.useState)(!1),[c,m]=(0,l.useState)(""),[u,h]=(0,l.useState)(""),[p,g]=(0,l.useState)(""),[b,f]=(0,l.useState)(""),[j,y]=(0,l.useState)("idle"),[v,N]=(0,l.useState)(""),[w,S]=(0,l.useState)(!0),C=async()=>{if(e){S(!0);try{let s=(await x.get("/payments/".concat(e))).payments.sort((e,s)=>new Date(s.timestamp).getTime()-new Date(e.timestamp).getTime());n(s)}catch(e){console.error("Error fetching payments:",e)}finally{S(!1)}}};(0,l.useEffect)(()=>{C()},[e]);let _=async(s,t,a,l,r)=>{y("loading"),N("");try{await x.post("/transaction/payment",{from_account:e,to_address:t,amount:s,currency:a,memo_id:l||void 0,memo:r||void 0}),m(""),h(""),g(""),f(""),y("success"),await C()}catch(e){throw N(e.message),y("error"),e}};return(0,a.jsxs)("div",{className:"flex flex-col h-screen bg-gray-900 text-gray-100",children:[(0,a.jsxs)("div",{className:"flex-none p-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Payments"}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!c||!u){N("Amount and destination address are required");return}o(!0)},className:"mb-6 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",value:c,onChange:e=>m(e.target.value),placeholder:"Send Amount",className:"w-full bg-gray-800 border border-gray-700 rounded-md p-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("select",{value:s,onChange:e=>t(e.target.value),className:"bg-gray-800 border border-gray-700 rounded-md p-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none pr-8",children:[(0,a.jsx)("option",{value:"XRP",children:"XRP"}),(0,a.jsx)("option",{value:"PFT",children:"PFT"})]}),(0,a.jsx)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 pointer-events-none",children:(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,a.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"To Address",className:"w-full bg-gray-800 border border-gray-700 rounded-md p-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),placeholder:"Memo ID (optional)",className:"w-full bg-gray-800 border border-gray-700 rounded-md p-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("input",{type:"text",value:b,onChange:e=>f(e.target.value),placeholder:"Memo (Optional)",className:"flex-1 bg-gray-800 border border-gray-700 rounded-md p-2 text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 mr-2"}),(0,a.jsx)("button",{type:"submit",className:"bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-2 rounded-md transition-colors",children:"Send"})]})]})]}),v&&(0,a.jsx)("div",{className:"text-red-500 text-sm mt-2",children:v})]})]}),(0,a.jsx)("div",{className:"flex-1 min-h-0",children:(0,a.jsx)("div",{className:"h-full overflow-y-auto px-4",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{className:"sticky top-0 bg-gray-900 z-10",children:(0,a.jsxs)("tr",{className:"border-b border-gray-700",children:[(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"#"}),(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"Date"}),(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"Amount"}),(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"Token"}),(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"To/From"}),(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"Address"}),(0,a.jsx)("th",{className:"p-4 text-gray-400 font-normal",children:"Tx Hash"})]})}),(0,a.jsx)("tbody",{children:w?[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsxs)("tr",{className:"border-b border-gray-800 animate-pulse",children:[(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-8 bg-gray-700 rounded"})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-24 bg-gray-700 rounded"})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-16 bg-gray-700 rounded"})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-12 bg-gray-700 rounded"})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-8 bg-gray-700 rounded"})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-32 bg-gray-700 rounded"})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("div",{className:"h-4 w-40 bg-gray-700 rounded"})})]},"skeleton-".concat(s))):0===r.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:7,className:"text-center p-8 text-gray-400",children:"No transactions found"})}):r.map((s,t)=>(0,a.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[(0,a.jsx)("td",{className:"p-4 text-gray-300",children:t+1}),(0,a.jsx)("td",{className:"p-4 text-gray-300 whitespace-nowrap",children:s.timestamp}),(0,a.jsx)("td",{className:"p-4 text-gray-300",children:s.amount_xrp>0?s.amount_xrp:s.amount_pft}),(0,a.jsx)("td",{className:"p-4 text-gray-300",children:s.amount_xrp>0?"XRP":s.amount_pft>0?"PFT":""}),(0,a.jsx)("td",{className:"p-4 text-gray-300",children:s.from_address===e?"To":"From"}),(0,a.jsx)("td",{className:"p-4 text-gray-300 font-mono",children:s.from_address===e?s.to_address:s.from_address}),(0,a.jsx)("td",{className:"p-4 text-gray-300 font-mono",children:(0,a.jsxs)("a",{href:"https://livenet.xrpl.org/transactions/".concat(s.hash),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 hover:underline",children:[s.hash.substring(0,10),"..."]})})]},t))})]})})}),(0,a.jsx)(k,{isOpen:i,onClose:()=>o(!1),onSubmit:_,initialAmount:c,initialToAddress:u,initialCurrency:s,initialMemoId:p,initialMemo:b})]})};function C(e){let{onAuth:s}=e,[t,r]=(0,l.useState)("signin"),[n,i]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[c,m]=(0,l.useState)(""),[u,h]=(0,l.useState)(""),[p,g]=(0,l.useState)(""),[b,f]=(0,l.useState)(!1),[j,y]=(0,l.useState)(""),[v,N]=(0,l.useState)(!1),w=async e=>{if(e.preventDefault(),y(""),N(!0),"signup"===t&&o!==c){y("Passwords do not match");return}let a="";if("signin"===t)a="/auth/signin";else if("generate"===t)a="/auth/create";else{y("Invalid mode for submission.");return}try{console.log("Sending POST request to ".concat(a));let e=await x.post(a,{username:n,password:o,..."generate"===t&&{private_key:u,address:p}});console.log("Auth data:",e);try{await x.post("/tasks/initialize/".concat(e.address)),console.log("Tasks initialized successfully")}catch(e){throw console.error("Task initialization error:",e),e}"generate"===t?(i(""),d(""),h(""),g(""),r("signin"),y("Account created successfully! Please sign in.")):s(e.address,n,o)}catch(e){console.error("Error in handleSubmit:",e),y(e instanceof Error?e.message:"An unknown error occurred")}finally{N(!1)}},k=async()=>{console.log("handleGenerateWallet called");try{console.log("Sending wallet generation request");let e=await x.post("/wallet/generate");console.log("Wallet data:",e),h(e.private_key),g(e.address)}catch(e){console.error("Error in handleGenerateWallet:",e),y(e instanceof Error?e.message:"An unknown error occurred")}};return"generate"===t?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-950",children:(0,a.jsxs)("div",{className:"bg-slate-900 p-8 rounded-lg border border-slate-800 w-full max-w-md",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-6",children:"Create New Wallet"}),u&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-yellow-900/30 border border-yellow-700 rounded-lg",children:[(0,a.jsx)("p",{className:"text-yellow-500 text-sm font-medium",children:(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Important Warning"]})}),(0,a.jsxs)("p",{className:"text-yellow-400 text-sm mt-1",children:["Please save your XRP Secret in a secure location. If you lose it, it ",(0,a.jsx)("span",{className:"font-bold",children:"cannot be recovered"})," and you will permanently lose access to your funds."]})]}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"XRP Address"}),(0,a.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"XRP Secret"}),(0,a.jsx)("button",{type:"button",onClick:()=>f(!b),className:"text-xs text-slate-400 hover:text-slate-300",children:b?"Hide Secret":"Show Secret"})]}),(0,a.jsx)("input",{type:b?"text":"password",value:u,onChange:e=>h(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Username"}),(0,a.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Password"}),(0,a.jsx)("input",{type:"password",value:o,onChange:e=>d(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white",required:!0,minLength:8})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Confirm Password"}),(0,a.jsx)("input",{type:"password",value:c,onChange:e=>m(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white",required:!0,minLength:8})]}),j&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:j}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("button",{type:"button",onClick:k,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg",children:"Generate New XRP Wallet"}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg",children:"Create Account"})]})]}),(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)("button",{onClick:()=>r("signin"),className:"text-blue-400 hover:text-blue-300 text-sm",children:"Back to Sign In"})})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-950",children:(0,a.jsxs)("div",{className:"bg-slate-900 p-8 rounded-lg border border-slate-800 w-full max-w-md",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-white mb-6",children:"signin"===t?"Sign In":"Create New Wallet"}),(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Username"}),(0,a.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Password"}),(0,a.jsx)("input",{type:"password",value:o,onChange:e=>d(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 text-white",required:!0,minLength:8})]}),j&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:j}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg",children:"signin"===t?"Sign In":"Create Wallet"})]}),(0,a.jsx)("div",{className:"mt-4 text-center space-y-2",children:"signin"===t&&(0,a.jsx)("div",{children:(0,a.jsx)("button",{onClick:()=>r("generate"),className:"text-blue-400 hover:text-blue-300 text-sm",children:"Create a new Account"})})})]})})}function _(e){let{username:s,onSignOut:t,activePage:l,onPageChange:r}=e;return(0,a.jsx)("nav",{className:"bg-slate-900 border-b border-slate-800",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"text-white font-bold text-xl",children:"Post Fiat Wallet"}),(0,a.jsx)("div",{className:"flex space-x-2",children:[{label:"Summary",id:"summary"},{label:"Active Tasks",id:"proposals"},{label:"Finished Tasks",id:"rewards"},{label:"Payments",id:"payments"},{label:"Memos",id:"memos"},{label:"Settings",id:"settings"}].map(e=>(0,a.jsx)("button",{onClick:()=>r(e.id),className:"px-4 py-2 rounded-md text-sm font-medium \n                    ".concat(l===e.id?"bg-slate-800 text-white":"text-slate-300 hover:bg-slate-800 hover:text-white"," \n                    transition-colors duration-200 ease-in-out"),children:e.label},e.id))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("span",{className:"text-slate-300",children:s}),(0,a.jsx)("button",{onClick:t,className:"bg-slate-800 hover:bg-slate-700 text-white px-4 py-2 rounded-lg text-sm",children:"Sign Out"})]})]})})})}let E=e=>{let{initStatus:s,address:t,onCheckStatus:r}=e,[n,i]=(0,l.useState)(null),{username:o,clearAuth:c}=(0,l.useContext)(d),[m,u]=(0,l.useState)(!1),[p,g]=(0,l.useState)(!1),[b,f]=(0,l.useState)(""),[j,y]=(0,l.useState)(""),[v,N]=(0,l.useState)(!1),[w,k]=(0,l.useState)(""),[S,C]=(0,l.useState)(!1),_=async()=>{try{let e=await x.get("/balance/".concat(t));i(e)}catch(e){console.error("Error fetching balance:",e)}},E=async()=>{try{let e=await x.get("/account/".concat(t,"/status?refresh=true"));console.log("Status check result:",e),r({init_rite_status:e.init_rite_status})}catch(e){console.error("Error checking init status:",e),r({init_rite_status:"UNSTARTED"})}},P=async e=>{e.preventDefault(),u(!0)},T=async e=>{k(""),N(!0);try{let s=await x.post("/wallet/ecdhkey",{account:t,password:e}),a={account:t,password:e,username:o,initiation_rite:b,google_doc_link:j,ecdh_public_key:s.ecdh_public_key,use_pft_for_doc:!1},l=await x.post("/initiation/full-sequence",a);console.log("Initiation submitted successfully:",l),C(!0),r({init_rite_status:"PENDING_INITIATION"});let n=setInterval(async()=>{await E()},1e4);setTimeout(()=>{clearInterval(n),C(!1)},12e4)}catch(e){console.error("Error submitting initiation:",e),k(e instanceof Error?e.message:"Failed to submit initiation"),C(!1)}finally{N(!1),g(!1)}};return((0,l.useEffect)(()=>{_();let e=setInterval(_,1e4);return()=>clearInterval(e)},[t]),(0,l.useEffect)(()=>{if("PENDING_INITIATION"===s){let e=setInterval(()=>{E(),_()},1e4);return()=>clearInterval(e)}},[s,t,r]),["INITIATED","COMPLETE"].includes(s))?null:(0,a.jsxs)("div",{className:"min-h-screen bg-slate-950",children:[(0,a.jsx)("nav",{className:"bg-slate-900 border-b border-slate-800",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:"text-white font-medium",children:o})}),(0,a.jsx)("button",{onClick:c,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md text-sm font-medium",children:"Logout"})]})})}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"bg-slate-900 rounded-lg p-6 text-white",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Welcome to Post Fiat"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Wallet Address:"}),(0,a.jsx)("p",{className:"font-mono",children:t}),n&&(0,a.jsxs)("p",{className:"text-sm text-gray-400 mt-2",children:["Balance: ",n.xrp," XRP / ",n.pft," PFT"]})]}),(()=>{let e=n?parseFloat(n.xrp):0;if(S)return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-white",children:"Initiation Submitted"}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-500/10 to-blue-600/10 border border-blue-500/20 rounded-xl p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-400 animate-spin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-blue-400",children:"Processing Your Initiation"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-gray-300",children:"Your initiation has been submitted to the blockchain. It may take a minute or two to be confirmed."}),(0,a.jsx)("div",{className:"bg-slate-900/50 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-gray-400",children:"The page will automatically update once your initiation is confirmed. Please be patient."})}),(0,a.jsxs)("div",{className:"border-t border-blue-500/20 pt-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-400 mb-3",children:"What's happening now:"}),(0,a.jsxs)("ol",{className:"space-y-3 text-gray-300",children:[(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full bg-blue-500/20 text-blue-400 text-sm",children:"1"}),(0,a.jsx)("span",{children:"Your initiation rite is being recorded on the XRP Ledger"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full bg-blue-500/20 text-blue-400 text-sm",children:"2"}),(0,a.jsx)("span",{children:"A secure connection is being established with the PostFiat node"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full bg-blue-500/20 text-blue-400 text-sm",children:"3"}),(0,a.jsx)("span",{children:"Your Google Doc link is being securely stored"})]})]})]})]})]})]});if(e<=0)return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-white",children:"Step 1: Fund Your Wallet"}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-500/10 to-blue-600/10 border border-blue-500/20 rounded-xl p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-blue-400",children:"Wallet Funding Required"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-gray-300",children:"Before you can complete the initiation process, you need at least 2 XRP in your wallet."}),(0,a.jsxs)("div",{className:"bg-slate-900/50 rounded-lg p-4",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"Current balance:"}),(0,a.jsxs)("span",{className:"ml-2 text-xl font-medium text-white",children:[(null==n?void 0:n.xrp)||"0"," XRP"]})]}),(0,a.jsxs)("div",{className:"border-t border-blue-500/20 pt-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-400 mb-3",children:"To fund your wallet:"}),(0,a.jsxs)("ol",{className:"space-y-3 text-gray-300",children:[(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full bg-blue-500/20 text-blue-400 text-sm",children:"1"}),(0,a.jsx)("span",{children:"Send XRP from another wallet or exchange"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full bg-blue-500/20 text-blue-400 text-sm",children:"2"}),(0,a.jsx)("span",{children:"Use your wallet address shown above"})]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full bg-blue-500/20 text-blue-400 text-sm",children:"3"}),(0,a.jsx)("span",{children:"Wait for the transaction to confirm"})]})]})]})]})]})]});switch(s){case"UNSTARTED":return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-white",children:"Step 2: Complete Initiation"}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-500/10 to-blue-600/10 border border-blue-500/20 rounded-xl p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-blue-400",children:"Complete Your Initiation"})]}),(0,a.jsxs)("form",{onSubmit:P,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"initiation-rite",className:"block text-sm font-medium text-gray-300 mb-2",children:"Initiation Rite"}),(0,a.jsx)("textarea",{id:"initiation-rite",value:b,onChange:e=>f(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:4,placeholder:"Write your initiation rite here...",required:!0}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-400",children:"Your initiation rite should be a thoughtful statement about your intentions and goals."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"google-doc",className:"block text-sm font-medium text-gray-300 mb-2",children:"Google Doc Link"}),(0,a.jsx)("input",{type:"url",id:"google-doc",value:j,onChange:e=>y(e.target.value),className:"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://docs.google.com/...",required:!0}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-400",children:"Share a Google Doc that contains your detailed background and interests."})]}),w&&(0,a.jsx)("div",{className:"text-red-500 text-sm",children:w}),(0,a.jsx)("div",{className:"pt-4 border-t border-slate-800",children:(0,a.jsxs)("button",{type:"submit",disabled:v,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)("span",{children:v?"Submitting...":"Submit Initiation"}),(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]})}),(0,a.jsxs)("div",{className:"bg-blue-900/20 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-400 mb-2",children:"What happens next?"}),(0,a.jsxs)("ul",{className:"space-y-2 text-sm text-gray-300",children:[(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"h-4 w-4 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Create a trust line for the PFT token"]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"h-4 w-4 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Submit your initiation rite transaction"]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"h-4 w-4 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Send handshake transactions to the node and remembrancer"]}),(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"h-4 w-4 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Submit your Google Doc context link"]})]})]})]})]}),m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-slate-900 border border-slate-800 rounded-lg w-full max-w-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Confirm Initiation"}),(0,a.jsx)("p",{className:"text-gray-300 mb-4",children:"Are you sure you want to submit your initiation? This will:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside text-gray-300 mb-6 space-y-2",children:[(0,a.jsx)("li",{children:"Create a trust line for the PFT token"}),(0,a.jsx)("li",{children:"Submit your initiation rite"}),(0,a.jsx)("li",{children:"Set up secure communication with the network"}),(0,a.jsx)("li",{children:"Submit your context document"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>u(!1),className:"px-4 py-2 text-sm font-medium text-slate-300 hover:text-white",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{u(!1),g(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors text-sm font-medium",children:"Confirm"})]})]})}),(0,a.jsx)(h,{isOpen:p,onClose:()=>g(!1),onConfirm:T,error:w})]});case"INITIATED":case"COMPLETE":return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Initiation Complete"}),(0,a.jsx)("p",{children:"Your account has been successfully initiated. You can now use the network."})]});case"PENDING":return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Initiation Pending"}),(0,a.jsx)("p",{children:"Your initiation request is being processed. Please check back soon."})]});case"REJECTED":return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Initiation Rejected"}),(0,a.jsx)("p",{children:"Your initiation request was not accepted. Please contact support for more information."})]});default:return(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Account Setup Required"}),(0,a.jsx)("p",{children:"Additional setup is needed for your account."}),(0,a.jsxs)("p",{className:"text-sm text-gray-400 mt-2",children:["Status: ",s]})]})}})()]})})]})},P=e=>{let{address:s}=e,t=(0,l.useContext)(d),r="rJ1mBMhEBKack5uTQvM8vWoAntbufyG9Yn",[n,i]=(0,l.useState)("odv"),[o,c]=(0,l.useState)(!1),[m,u]=(0,l.useState)(!1),[p,g]=(0,l.useState)(null),[b,f]=(0,l.useState)(!1),[j,y]=(0,l.useState)(!1),[v,N]=(0,l.useState)(),[w,k]=(0,l.useState)(!1),[S,C]=(0,l.useState)(),[_,E]=(0,l.useState)(null),[P,T]=(0,l.useState)(!1),[I,D]=(0,l.useState)(null),[A,R]=(0,l.useState)(!1),[F,M]=(0,l.useState)(""),[L,q]=(0,l.useState)([{address:r,displayName:"ODV",lastMessage:"Greetings. I am ODV, a mediator between you and Future AI. I'm here to help translate strategic insights focused on life extension and wealth creation. How may I assist you today?",timestamp:Date.now(),unread:0}]),[O,z]=(0,l.useState)("ODV"),[W,V]=(0,l.useState)(!1),[B,H]=(0,l.useState)(null),[U,G]=(0,l.useState)(""),[X,Y]=(0,l.useState)([{id:"1",from:"ODV",to:s,content:"Greetings. I am ODV, a mediator between you and Future AI. I'm here to help translate strategic insights focused on life extension and wealth creation. How may I assist you today?",timestamp:Date.now()-1e3}]),[J,K]=(0,l.useState)(""),[$,Z]=(0,l.useState)(null),Q=l.useRef(null);(0,l.useEffect)(()=>{P&&X.length>0&&!o&&!b&&Q.current&&(Q.current.scrollTop=Q.current.scrollHeight)},[X,P,o,b]);let ee=async function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!s)return;let l=e||I||t.password;if(!l){N(void 0),y(!0);return}u(!0);try{let[n]=await Promise.all([x.post("/odv/messages/".concat(s),{password:l,refresh:a}),new Promise(e=>setTimeout(e,1e3))]);if("success"===n.status){let s=n.messages.map(e=>({id:e.id,from:e.from,to:e.to,content:e.content,timestamp:e.timestamp}));if(Y(s),s.length>0){let e=s[s.length-1];q(s=>s.map(s=>s.address===r?{...s,lastMessage:e.content,timestamp:e.timestamp,unread:0}:s))}T(!0),e&&!I&&(D(e),t.setPassword&&t.setPassword(e))}}catch(e){console.error("Error fetching messages:",e),g(e instanceof Error?e.message:"An error occurred"),"decryptMessages"===_&&C(e instanceof Error?e.message:"Failed to decrypt messages")}finally{c(!1),u(!1),f(!1)}},es=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;null!==$&&clearTimeout($);let s=window.setTimeout(()=>{ee(void 0,!0),Z(null)},e);Z(Number(s))};(0,l.useEffect)(()=>{if(!s||!P)return;let e=setInterval(()=>{ee(void 0,!0)},3e4);return()=>clearInterval(e)},[s,P]);let et=async e=>{try{"sendMessage"===_?(await ea(e),!I&&(D(e),t.setPassword&&t.setPassword(e))):"sendLog"===_?(await el(e),!I&&(D(e),t.setPassword&&t.setPassword(e))):"decryptMessages"===_&&await ee(e),k(!1),E(null)}catch(e){console.error("Password operation failed:",e)}},ea=async e=>{if(!J.trim()||!s){g("Please enter a message");return}c(!0);try{let t={account:s,password:e,message:J.trim(),amount_pft:1};console.log("Sending message request:",{url:"/odv/send_message",method:"POST",body:JSON.stringify({...t,password:"[REDACTED]"})});let a=await x.post("/odv/send_message",t);if(console.log("Parsed response data:",a),"success"===a.status){let e={id:a.message_id,from:s,to:r,content:J.trim(),timestamp:Date.now()};Y(s=>[...s,e]),K(""),q(e=>e.map(e=>e.address===r?{...e,lastMessage:J.trim(),timestamp:Date.now(),unread:0}:e)),es(5e3)}}catch(e){throw console.error("Error sending message:",e),e instanceof Error?console.log("Error details:",{name:e.name,message:e.message,stack:e.stack}):console.log("Unknown error type:",e),g(e instanceof Error?e.message:"An error occurred"),C(e instanceof Error?e.message:"Failed to send message"),e}finally{c(!1)}},el=async e=>{c(!0),g(null);try{let t=await x.post("/odv/send_log",{account:s,password:e,log_content:J.trim(),amount_pft:1}),a={id:"local_".concat(Date.now()),from:s,to:r,content:J.trim(),timestamp:Date.now()};Y(e=>[...e,a]),K(""),I||D(e),console.log("Log sent:",t),es(3e3)}catch(e){console.error("Error sending log:",e),g(e.message)}finally{c(!1)}},er=()=>{if(!J.trim()){g("Please enter a message");return}let e=t.password||I;e?ea(e).catch(()=>{E("sendMessage"),C("Stored password is invalid. Please enter your password again."),k(!0),D(null),t.setPassword&&t.setPassword("")}):(E("sendMessage"),C(void 0),k(!0))},en=()=>{if(!J.trim()){g("Please enter a log message");return}let e=t.password||I;e?el(e).catch(()=>{E("sendLog"),C("Stored password is invalid. Please enter your password again."),k(!0),D(null),t.setPassword&&t.setPassword("")}):(E("sendLog"),C(void 0),k(!0))},ei=()=>{"odv"===n?er():"logging"===n&&en()},eo=async e=>{R(!0);try{await ee(e),y(!1)}catch(e){console.error("Error decrypting messages:",e),N(e instanceof Error?e.message:"Failed to decrypt messages")}finally{R(!1)}};(0,l.useEffect)(()=>{s&&(t.password?(f(!0),ee(t.password).catch(()=>{D(null),t.setPassword&&t.setPassword(""),T(!1),f(!1),N("Stored password is invalid. Please enter your password again."),y(!0)})):I?(f(!0),ee(I).catch(()=>{D(null),T(!1),f(!1),N("Stored password is invalid. Please enter your password again."),y(!0)})):P||(N(void 0),y(!0)))},[s]);let ed=(e,s)=>{s.stopPropagation(),H(e),G(e.displayName),V(!0)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex h-[calc(100vh-120px)] overflow-hidden",children:[(0,a.jsxs)("div",{className:"w-1/4 min-w-[250px] border-r border-slate-700 flex flex-col",children:[(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:L.map(e=>(0,a.jsxs)("div",{onClick:()=>z(e.address),className:"p-4 cursor-pointer hover:bg-slate-800 relative ".concat(O===e.address?"bg-slate-800":""),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{className:"font-medium text-slate-200",children:e.displayName}),(0,a.jsx)("button",{onClick:s=>ed(e,s),className:"text-slate-400 hover:text-slate-200 p-1 opacity-60 hover:opacity-100 transition-opacity",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 01.67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 11-.671-1.34l.041-.022zM12 9a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})})})]}),(0,a.jsx)("div",{className:"text-sm text-slate-400 truncate",children:e.lastMessage})]},e.address))}),(0,a.jsx)("div",{className:"border-t border-slate-700 p-4 sticky bottom-0 bg-slate-900",children:(0,a.jsxs)("div",{className:"flex rounded-lg overflow-hidden",children:[(0,a.jsx)("button",{onClick:()=>i("odv"),className:"flex-1 py-2 px-3 flex justify-center items-center transition-colors ".concat("odv"===n?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:"ODV Chat"}),(0,a.jsx)("button",{onClick:()=>i("logging"),className:"flex-1 py-2 px-3 flex justify-center items-center transition-colors ".concat("logging"===n?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"),children:"Logging"})]})})]}),(0,a.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:O?(0,a.jsxs)(a.Fragment,{children:[p&&(0,a.jsxs)("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4 m-4",children:[(0,a.jsx)("p",{className:"text-red-400 text-sm",children:p}),(0,a.jsx)("button",{className:"text-xs text-red-400 hover:text-red-300 mt-2",onClick:()=>g(null),children:"Dismiss"})]}),(0,a.jsxs)("div",{ref:Q,className:"flex-1 overflow-y-auto p-4 space-y-4",children:[b||o?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"}),(0,a.jsx)("p",{className:"mt-4 text-slate-400",children:"Loading messages..."})]}):P?X.map((e,t)=>(0,a.jsx)("div",{className:"max-w-[70%] p-3 rounded-lg break-words overflow-hidden ".concat(e.from===s?"ml-auto bg-blue-600 text-white":"bg-slate-700 text-slate-200"),children:(0,a.jsx)("div",{className:"whitespace-pre-wrap break-all overflow-hidden",children:e.content})},"".concat(e.id||"msg","_").concat(t))):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:[(0,a.jsx)("p",{children:"Messages need to be decrypted"}),(0,a.jsx)("button",{onClick:()=>{N(void 0),y(!0)},className:"mt-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Decrypt Messages"})]}),m&&!b&&(0,a.jsx)("div",{className:"flex justify-center items-center p-2",children:(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 text-slate-400",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}),(0,a.jsx)("div",{className:"p-4 border-t border-slate-700 sticky bottom-0 bg-slate-900",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:J,onChange:e=>K(e.target.value),onKeyPress:e=>"Enter"===e.key&&ei(),placeholder:"odv"===n?"Type a message...":"Type a log entry...",className:"flex-1 bg-slate-800 text-slate-200 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:o||!P}),(0,a.jsx)("button",{onClick:ei,className:"bg-blue-600 text-white px-4 py-2 rounded-lg ".concat(o||!P?"opacity-50 cursor-not-allowed":"hover:bg-blue-700"),disabled:o||!P,children:o?"Sending...":"odv"===n?"Send":"Log"})]})})]}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center text-slate-400",children:"Select a conversation to start messaging"})})]}),W&&B&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6 max-w-md w-full",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-slate-200 mb-4",children:"Thread Information"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Address"}),(0,a.jsx)("div",{className:"text-slate-200 bg-slate-700 p-2 rounded break-all",children:B.address})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Nickname"}),(0,a.jsx)("input",{type:"text",value:U,onChange:e=>G(e.target.value),className:"w-full bg-slate-700 text-slate-200 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>V(!1),className:"px-4 py-2 text-slate-400 hover:text-slate-200",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{B&&U.trim()&&(q(L.map(e=>e.address===B.address?{...e,displayName:U.trim()}:e)),V(!1))},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Save"})]})]})}),(0,a.jsx)(h,{isOpen:w,onClose:()=>{k(!1),E(null)},onConfirm:et,error:S}),j&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-slate-800 p-6 rounded-lg max-w-md w-full",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-slate-200 mb-4",children:"Decrypt Messages"}),(0,a.jsx)("p",{className:"text-slate-400 mb-4",children:"Enter your wallet password to decrypt messages"}),v&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/20 rounded text-red-400 text-sm",children:v}),(0,a.jsx)("input",{type:"password",className:"w-full p-2 bg-slate-700 border border-slate-600 rounded mb-4 text-slate-200",placeholder:"Enter your password",value:F,onChange:e=>M(e.target.value),onKeyDown:e=>"Enter"===e.key&&eo(F)}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>y(!1),className:"px-4 py-2 bg-slate-700 text-slate-300 rounded hover:bg-slate-600",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>eo(F),disabled:A||!F.trim(),className:"px-4 py-2 rounded flex items-center justify-center min-w-[100px] ".concat(A||!F.trim()?"bg-blue-700/50 text-blue-300/50 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-300 border-t-transparent mr-2"}),"Decrypting..."]}):"Decrypt"})]})]})})]})},T=()=>{let{address:e,username:s}=(0,l.useContext)(d),[t,r]=(0,l.useState)(""),[n,i]=(0,l.useState)(null),[o,c]=(0,l.useState)(!1),[m,u]=(0,l.useState)(null),[h,p]=(0,l.useState)(!1),[g,b]=(0,l.useState)(!1),[f,j]=(0,l.useState)(!1),[y,v]=(0,l.useState)(!1),[N,w]=(0,l.useState)(null),[k,S]=(0,l.useState)(null),C=async s=>{s.preventDefault(),c(!0),u(null);try{let s=await x.post("/wallet/seed",{account:e,password:t});i(s.seed),p(!0),r("")}catch(e){console.error("Error retrieving seed:",e),u(e instanceof Error?e.message:"Failed to retrieve seed")}finally{c(!1)}},_=async s=>{w(null),S(null),"remembrancer"===s?j(!0):v(!0);try{await x.post("remembrancer"===s?"/transaction/handshake_remembrancer":"/transaction/handshake_node",{account:e,password:t,ecdh_public_key:"placeholder"}),S("Successfully sent handshake to ".concat(s,"!")),r("")}catch(e){console.error("Error sending handshake to ".concat(s,":"),e),w(e instanceof Error?e.message:"Failed to send handshake to ".concat(s))}finally{"remembrancer"===s?j(!1):v(!1)}};return(0,a.jsxs)("div",{className:"bg-slate-900 rounded-lg p-6 text-white",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Account Settings"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Account Information"}),(0,a.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4 mb-6",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Username"}),(0,a.jsx)("p",{className:"font-medium",children:s})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Wallet Address"}),(0,a.jsx)("p",{className:"font-mono text-sm break-all",children:e})]})]}),(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Network Connections"}),(0,a.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4 mb-6",children:[(0,a.jsx)("p",{className:"mb-4 text-sm text-gray-300",children:"Send handshake transactions to establish encrypted communication with network nodes."}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"handshake-password",className:"block text-sm font-medium text-gray-300 mb-1",children:"Enter your password to authorize handshakes"}),(0,a.jsx)("input",{type:"password",id:"handshake-password",value:t,onChange:e=>r(e.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 mb-3"})]}),N&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-800 rounded-md text-red-200 text-sm",children:N}),k&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-green-900/50 border border-green-800 rounded-md text-green-200 text-sm",children:k}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,a.jsx)("button",{onClick:()=>_("remembrancer"),disabled:f||y||!t,className:"bg-purple-600 hover:bg-purple-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white py-2 px-4 rounded-md transition duration-200 flex justify-center items-center",children:f?(0,a.jsx)("span",{children:"Sending..."}):(0,a.jsx)("span",{children:"Handshake Remembrancer"})}),(0,a.jsx)("button",{onClick:()=>_("node"),disabled:f||y||!t,className:"bg-teal-600 hover:bg-teal-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white py-2 px-4 rounded-md transition duration-200 flex justify-center items-center",children:y?(0,a.jsx)("span",{children:"Sending..."}):(0,a.jsx)("span",{children:"Handshake Task Node"})})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Backup & Security"}),h?(0,a.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Your Seed Phrase"}),(0,a.jsx)("button",{onClick:()=>p(!1),className:"text-sm text-gray-400 hover:text-white",children:"Hide"})]}),(0,a.jsx)("div",{className:"bg-slate-900 border border-yellow-500/30 rounded-md p-3 mb-4",children:(0,a.jsx)("p",{className:"font-mono break-all text-yellow-400",children:n})}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Store this somewhere safe and secure"}),(0,a.jsx)("button",{onClick:()=>{n&&(navigator.clipboard.writeText(n),b(!0),setTimeout(()=>b(!1),2e3))},className:"bg-slate-700 hover:bg-slate-600 text-white text-sm py-1 px-3 rounded-md flex items-center",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Copied"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,a.jsx)("path",{d:"M8 2a1 1 0 000 2h2a1 1 0 100-2H8z"}),(0,a.jsx)("path",{d:"M3 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6h-4.586l1.293-1.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L10.414 13H15v3a2 2 0 01-2 2H5a2 2 0 01-2-2V5zM15 11h2a1 1 0 110 2h-2v-2z"})]}),"Copy"]})})]})]}):(0,a.jsxs)("form",{onSubmit:C,className:"bg-slate-800 rounded-lg p-4",children:[(0,a.jsxs)("p",{className:"mb-4 text-yellow-400",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 inline-block mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Never share your seed phrase with anyone. It provides full access to your wallet."]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:"Enter your password to reveal your seed phrase"}),(0,a.jsx)("input",{type:"password",id:"password",value:t,onChange:e=>r(e.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),m&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-800 rounded-md text-red-200 text-sm",children:m}),(0,a.jsx)("button",{type:"submit",disabled:o||!t,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 disabled:cursor-not-allowed text-white py-2 px-4 rounded-md transition duration-200",children:o?"Loading...":"Reveal Seed Phrase"})]})]})]})]})};function I(){let[e,s]=(0,l.useState)("summary"),[t,r]=(0,l.useState)({isAuthenticated:!1,address:null,username:null,password:null}),[n,i]=(0,l.useState)(null),[o,d]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=localStorage.getItem("wallet_address"),s=localStorage.getItem("username");e&&s&&r({isAuthenticated:!0,address:e,username:s,password:null})},[]),(0,l.useEffect)(()=>{let e=async()=>{if(t.address)try{console.log("Checking init status for address:",t.address);let e=await x.get("/account/".concat(t.address,"/status?refresh=true&nocache=").concat(Date.now()));console.log("Initiation status response:",e),i(e.init_rite_status||"UNSTARTED")}catch(e){console.error("Error checking initialization status:",e),i("UNSTARTED")}finally{d(!1)}};if(t.isAuthenticated){e();let s=setInterval(()=>{e()},1e4);return()=>clearInterval(s)}d(!1)},[t.isAuthenticated,t.address]);let m=async()=>{if(console.log("Signing out and resetting all state..."),t.address)try{await x.post("/tasks/clear-state/".concat(t.address)),console.log("Server state cleared for account:",t.address)}catch(e){console.error("Error clearing server state:",e)}r({isAuthenticated:!1,address:null,username:null,password:null}),i(null),s("summary"),localStorage.removeItem("wallet_address"),localStorage.removeItem("username"),setTimeout(()=>{console.log("Sign out complete, state reset")},100)};return t.isAuthenticated?o?(0,a.jsx)("div",{children:"Loading..."}):n&&["UNSTARTED","PENDING_INITIATION","PENDING"].includes(n)?(0,a.jsx)(c,{value:t,onClearAuth:m,children:(0,a.jsx)(E,{initStatus:n,address:t.address,onCheckStatus:e=>{i(e.init_rite_status)}})}):(0,a.jsx)(c,{value:t,onClearAuth:m,children:(0,a.jsxs)("div",{className:"min-h-screen bg-slate-950",children:[(0,a.jsx)(_,{username:t.username,onSignOut:m,activePage:e,onPageChange:e=>{s(e)}}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:(()=>{switch(e){case"proposals":return(0,a.jsx)(v,{});case"verification":return(0,a.jsx)(N,{});case"rewards":return(0,a.jsx)(w,{});case"payments":return(0,a.jsx)(S,{});case"memos":return(0,a.jsx)(P,{address:t.address});case"settings":return(0,a.jsx)(T,{});default:return(0,a.jsx)(u,{})}})()})]})}):(0,a.jsx)(C,{onAuth:(e,s,t)=>{r({isAuthenticated:!0,address:e,username:s,password:t}),localStorage.setItem("wallet_address",e),localStorage.setItem("username",s)}})}}},e=>{var s=s=>e(e.s=s);e.O(0,[441,517,358],()=>s(8148)),_N_E=e.O()}]);